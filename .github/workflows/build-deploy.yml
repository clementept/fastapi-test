name: Build and Deploy Code

on: [push, pull_request]

jobs:
    job1:
        env:
            DATABASE_HOSTNAME: localhost
            DATABASE_PORT: 5432
            DATABASE_PASSWORD: donotbothermemorizing
            DATABASE_NAME: fastapi_posts
            TEST_DATABASE_NAME: fastapi_posts_test
            DATABASE_USERNAME: postgres
            JWT_SECRET_KEY: 277aa6249446988ece1d8787b2c4dc0944276a56b7056823ed03a00fc55cced6
            JWT_ALGORYTHM: HS256
            JWT_ACCESS_TOKEN_EXPIRE_MINUTES: 60
        runs-on: ubuntu-latest
        steps:
            - name: Pulling git repo
              uses: actions/checkout@v2

            - name: Install python v3.12.1
              uses: actions/setup-python@v2
              with:
                python-version: "3.12.1"

            - name: Update pip
              run: python -m pip install --upgrade pip

            - name: Install all dependencies
              run: pip install -r requirements.txt 

            - name: Test with pytest
              run: |
                pip install pytest
                pytest

   